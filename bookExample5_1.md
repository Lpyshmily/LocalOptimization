# bookExample5_1

本程序的目标是实现《深空探测动力学与控制》第五章中的第一个算例，从地球到进行的交会问题。

## 1st version

* 分别采用**春分点轨道根数**和**直角坐标**实现了间接法求解从地球到金星1000天转移的例子
  * 春分点轨道根数(`ModelFun`)：需要特别考虑最后一个轨道根数，人为指定不同的圈数，3圈时剩余质量最多，即为最优解。收敛速度较快，随机猜测100次基本足够。
  * 直角坐标(`Cartesian`)：状态变量和协态变量的导数计算较为简单，无需进行额外推导。但是收敛速度较慢，随机猜测100次得不到收敛解。增大猜测次数，可以得到收敛解，但可能收敛到4圈/5圈等其他情况。

## 2nd version

* 输出了推力大小随时间的变化，文件名称为`amplitude.txt`
* 将控制律改为bang-bang控制，即根据开关函数的正负，设置推力大小为0或1。采用春分点轨道根数，随机猜测100次，可以得到收敛解

## 3rd version

通过改变初始质量，观察轨迹的变化。

| 初始质量/kg | 同伦_剩余质量/kg | bang-bang_剩余质量/kg |
| ----------- | ---------------- | --------------------- |
| 1000        | 8861.196         |                       |
| 1100        | 947.126          |                       |
| 1200        | 1032.996         |                       |
| 1300        | 1118.817         |                       |
| 1400        | 1204.696         | 1204.703              |
| 1500        | 1290.565         | 1290.573              |



* 输出内容：积分过程中积分变量随时间的变化、推力大小随时间的变化，随机猜测协态初值，没有同伦过程

  * 同伦参数$\epsilon=1\times 10^{-5}$，初始质量分别为1000、1100、1200、1300、1400、1500 kg

    输出文件为`temp_1000.txt`和`amplitude_1000.txt`

  * bang-bang控制，ode45变步长积分，初始质量分别为1000、1100、1200、1300、1400、1500 kg

    输出文件为`temp_b1000.txt`和`amplitude_b1000.txt`

* Matlab文件：

  * `tempPlot.m`：二维、三维轨迹图
  * `amplitudePlot.m`：推力大小随时间的变化
  * `connected.m`：采用bang-bang控制输出结果，在二维轨迹图中，用颜色区分有无推力

输出文件、Matlab程序，结果图片分别存放在data_process中的三个子文件夹中。

通过改变初始质量发现，当初始质量小于1200 kg时，二维轨迹会接近相交。