# bookExample5_2

本程序的目标是实现《深空探测动力学与控制》第五章中的第二个算例，从地球到木星经火星引力辅助的交会问题

## 1st version

* 引力辅助后开启发动机：完成了PSO搜索引力辅助的最佳时刻，并计算最小的脉冲速度增量
* 公共近星点开启发动机：采用割线法目前无法得到非线性方程的收敛解

## 2nd version

* 将PSO搜索引力辅助时刻的头文件和源文件名字改为`GA_PSO`
* 小推力求解的文件名称为`GA_FOP`
* 不再将`mjd_middle`作为参数进行传递，直接从`Constant.h`头文件中读取
* 目前已经完成了导数的计算，打靶方程偏差的计算，还没有进行打靶方程的求解。

## 3rd version

* 完成了整个程序的编程，没有报错，但是迭代计算第一步起就不正常。
* 修正了一个错误：引力辅助后在原来的速度上加上速度改变量`dvg`，仍不能正常运行。

## 4th version

* 修正了一个错误，`GA_fvec()`函数中，A、B、C赋值时，索引值从1开始，应该从0开始。
* 改变了速度增量的初值猜测方法。

* 修正了一个错误，$V_{\infty}^+$的计算方式有误

```c++
V_Add(vinfout, &rv_tm[3], dvg, 3);
// 应改为下面这种
V_Add(vinfout, vinfin, dvg, 3);
```

## 5th version

* 又检查了一遍，没有发现问题。

## 6th version

* 按照蒋老师的指导意见，修改程序

1. 调用`hybrid1`函数时，`wa`的维数至少为`n(3n+13)/2`，本程序中打靶变量个数$n=17$，因此将`wa`的维数改为600。

2. 调用`hybrid1`函数时，最后一个参数设大一些，改为2000。

3. 修改一些初值猜测值的猜测范围。

4. 暂时取消向文件中读写的操作。

5. 把PSO搜索到的引力辅助时刻当作初始值

   修改之后，Debug模式下step过大的问题不再出现，这个问题之前应该是`wa`维数设置的太小导致的。

   目前希望通过增加猜测次数，寻找收敛解。

## 7th version

* 从迟师姐的Fortran程序中获取猜测初值
  * 长度单位是km
  * 归一化：长度，AU；时间，年；质量，初始质量
  * 打靶变量：[1]lam0,[2]lamm,[3]lamk,[4-6]lamr,[7-9]lamv,[10-13]lamx,[14-16]dvg,[17]tm
  * 打靶方程：
  * 采用同伦参数为0.0004的初值，前13个猜测值的2范数为1。对速度增量进行修改，然后带入我的程序，不收敛。
  * 采用同伦参数为0.00065的初值，也未能收敛。
  * 迟师姐所用的打靶方程是$rp-rmin$，而我用的是$1-\frac{rp}{rmin}$，对应的乘子可能会相差一个倍数
    * 将这个乘子乘以$rmin$，然后再重新归一化，仍然未能收敛。
    * 将我的打靶方程改为$rmin-rp$，未能收敛。
    * 将我的打靶方程改为$rp-rmin$，未能收敛。

## 8th version

* 采用同伦参数为1/2e-6的初值，也未能收敛。